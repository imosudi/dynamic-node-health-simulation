# Dynamic Node Health Simulation

A Modular Python Simulation Framework for Dynamic Node Health Scoring and Probabilistic Fault Injection in Fog Computing Networks. 

## Overview
This project simulates node health degradation in a hierarchical fog computing network deployed in a smart agricultural farm. It models behaviour metrics like Packet Loss Rate (PLR), CPU Usage, and Response Time (RTT), introducing dynamic fault injection, adaptive health thresholding, simulation control, and live visualization. Exports logs in JSON/CSV for analysis using Exponential Moving Average (EMA). 

## Features
- Node-specific behaviour metric profiles (PLR, CPU, RTT)
- Time-varying probabilistic fault injection (stress scenarios)
- Adaptive thresholding with EMA
- Health status classification (Good, Fair, Poor, Faulty)
- CLI-based simulation execution
- Live visualisation of node health vs thresholds (per node subplots)
- Persistent log export (CSV & JSON)

## Project Structure
```
dynamic-node-health-simulation/
├── data                                 --> Auto-generated node_list.csv
│   ├── fault_templates.yaml
│   ├── fault_templates_zero.yaml
│   └── templates.yaml
├── logs
│   ├── csv_writer.py
│   └── __init__.py
├── modules                             --> Core simulation modules
│   ├── fault_injector.py
│   ├── health_classifier.py
│   ├── node__data_generator.py
│   ├── node_operations
│   │   ├── logic.py
│   │   ├── node_generators.py
│   │   └── node_id_extract.py
│   ├── node_profiler.py
│   └── simulation_controller.py
├── output
├── main.py                             --> CLI Entry Point
├── LICENSE
└── README.md


```

## Quick Start

### 1. Clone Repository
```bash
git clone https://github.com/imosudi/dynamic-node-health-simulation.git
cd dynamic-node-health-simulation
```

### 2. Setup Python Environment
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 3. Run Simulation
```bash
python main.py
```

### 4. Output
- Logs: `logs/node_health_log.json` and `logs/node_health_log.csv`
- Visual: `logs/simulation_plot.png`

## Configuration Notes

This section documents the key configuration variables used by the simulation and where to change them.

Where to edit
- Configuration values are defined at the top of `main.py`. Edit that file to tune simulation behaviour.

Important variables
- default_weights: Metric importance used to compute node health. Example:
  - {'PLR': 0.4, 'CPU': 0.3, 'RTT': 0.3}
  - Keys map to Packet Loss Rate (plr), CPU usage (cpu) and Response Time (rtt).
- baseline_values: Typical (healthy) baseline for each metric. Example:
  - {"cpu": 0.090, "rtt": 22.8, "plr": 0.0068}
- max_values: Expected upper bounds used by fault/scale logic. Example:
  - {'cpu': 0.75, 'rtt': 150, 'plr': 0.5}
- static_thresholds: Hard thresholds used to classify degraded/faulty health. Example:
  - {'cpu': 0.73, 'rtt': 130.0, 'plr': 0.45}
  - Tip: choose thresholds between baseline and max (e.g., baseline + 50–80% of (max - baseline)), or set domain-specific static values.
- transceive_count_limit: Maximum transceive attempts considered in the transceive simulation (default in code: 20).
- fault_templates: YAML templates under `data/` control injected fault scenarios. Common files:
  - `data/fault_templates.yaml`
  - `data/fault_templates_zero.yaml`
  - Edit or add templates to tune fault probabilities and types.

Auto-generated and output files
- `data/node_list.csv` — auto-generated if missing (sample node profiles).
- `data/node_metrics.csv` — generated by NodeMetricsProcessor when metrics are collected.
- `data/node_metrics_with_transceive.csv` — export from transceive pre-processor.
- Logs and visual output are written to `logs/` (JSON/CSV and plots).

Recommended workflow
1. Tune `default_weights`, `baseline_values`, `max_values` and `static_thresholds` in `main.py`.
2. Optionally update YAML fault templates in `data/`.
3. Run `python main.py` to generate node lists, metrics, transceive data and logs.
4. Inspect CSV/JSON outputs in `data/` and `logs/`.

Example snippet (in `main.py`)
```python
default_weights = {'PLR': 0.4, 'CPU': 0.3, 'RTT': 0.3}
baseline_values = {"cpu":0.090, "rtt":22.8, "plr":0.0068}
max_values = {'cpu': 0.75, 'rtt': 150, 'plr': 0.5}
static_thresholds = {'cpu': 0.73, 'rtt': 130.0, 'plr': 0.45}
transceive_count_limit = 20
fault_templates = 'data/fault_templates.yaml'
```

Notes
- Metric key casing may differ across modules; follow existing keys in `main.py` when modifying.
- For experiments, keep copies of modified YAML/templates and exported CSVs for reproducibility.


## Use Cases
- Fog/Edge network resilience testing
- CPS anomaly detection simulations
- Smart agriculture network performance modelling
- Academic research in fault-tolerant distributed systems

## Future Enhancements
- Scenario-based YAML configurations
- Layer-specific fault models (energy depletion, load stress)
- Integration with real-time sensor emulators
