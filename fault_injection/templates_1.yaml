# Metrics: [0=RTT (ms), 1=CPU (%), 2=PLR (%)]

fault_templates:
  - id: correlated_power_loss
    name: correlated_power_loss
    type: additive
    affected_metrics: [0,1,2]
    severity_vector: [50, 30, 5]       # RTT +50ms, CPU +30%, PLR +5%
    covariance:
      rho: 0.8
      mode: pairwise_rho
    occurrence_model:
      type: bernoulli
      p: 0.0005
    duration_dist:
      type: geometric
      p: 0.05
    note: "High-correlation multi-metric disturbance"

  - id: scheduled_event
    name: scheduled_event
    type: additive
    affected_metrics: [0]
    severity_vector: [100]         # RTT +100ms
    schedule:
      start_steps: [5, 25, 50, 75] # when to trigger
      duration: 5                  # how many steps each lasts
    note: "Deterministic RTT spikes"

  - id: sensor_stuck_cpu
    name: sensor_stuck_cpu
    type: persistent
    subtype: stuck_at
    affected_metrics: [1]
    stuck_value: 100                    # CPU stuck at 100%
    duration_dist:
      type: deterministic
      n_steps: 500
    occurrence_model:
      type: bernoulli
      p: 0.0001
    repeatable: true
    note: "CPU sensor stuck high"

  - id: transient_rtt_glitch
    name: transient_rtt_glitch
    type: additive
    affected_metrics: [0]
    severity_vector: [200]              # RTT spike +200ms
    occurrence_model:
      type: bernoulli
      p: 0.01
    duration_dist:
      type: geometric
      p: 0.2
    note: "Short transient RTT spike"

  - id: plr_ramp_drift
    name: plr_ramp_drift
    type: persistent
    subtype: ramp
    affected_metrics: [2]
    ramp_slope: 0.2                     # 0.2% per step
    max_deviation: 10                   # max 10%
    duration_dist:
      type: geometric
      p: 0.1
    occurrence_model:
      type: bernoulli
      p: 0.0002
    repeatable: true
    note: "Gradual PLR drift"

  - id: intermittent_rtt_dropout
    name: intermittent_rtt_dropout
    type: persistent
    subtype: additive_persistent
    affected_metrics: [0]
    severity_vector: [500]              # RTT jump +500ms
    duration_dist:
      type: geometric
      p: 0.15
    occurrence_model:
      type: bernoulli
      p: 0.005
    repeatable: true
    note: "Intermittent RTT dropouts"

  - id: cpu_short_spike
    name: cpu_short_spike
    type: additive
    affected_metrics: [1]
    severity_vector: [70]               # CPU +70%
    occurrence_model:
      type: bernoulli
      p: 0.02
    duration_dist:
      type: geometric
      p: 0.3
    note: "Short CPU spike"

  - id: rtt_long_drift
    name: rtt_long_drift
    type: persistent
    subtype: ramp
    affected_metrics: [0]
    ramp_slope: 10                      # RTT +10ms per step
    max_deviation: 300                  # max +300ms
    duration_dist:
      type: geometric
      p: 0.05
    occurrence_model:
      type: bernoulli
      p: 0.0001
    repeatable: true
    note: "Slow RTT drift"

  - id: plr_noise_burst
    name: plr_noise_burst
    type: additive
    affected_metrics: [2]
    severity_vector: [8]                # PLR burst +8%
    occurrence_model:
      type: bernoulli
      p: 0.01
    duration_dist:
      type: geometric
      p: 0.25
    note: "Burst of random PLR noise"

  - id: cpu_complete_failure
    name: cpu_complete_failure
    type: persistent
    subtype: stuck_at
    affected_metrics: [1]
    stuck_value: 0                      # CPU at 0%
    duration_dist:
      type: deterministic
      n_steps: 1000
    occurrence_model:
      type: bernoulli
      p: 0.00005
    repeatable: false
    note: "CPU completely non-responsive"

  - id: rare_extreme_event
    name: rare_extreme_event
    type: additive
    affected_metrics: [0,1,2]
    severity_vector: [1000, 100, 50]    # RTT +1s, CPU +100%, PLR +50%
    covariance:
      rho: 0.9
      mode: pairwise_rho
    occurrence_model:
      type: bernoulli
      p: 0.0001
    duration_dist:
      type: geometric
      p: 0.02
    note: "Rare, catastrophic multi-metric failure"
